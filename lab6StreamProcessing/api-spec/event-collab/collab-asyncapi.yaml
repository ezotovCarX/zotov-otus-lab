asyncapi: 2.0.0
info:
  title: Регистрация пользователя
  version: '1.0.0'
  description: |
    Пример приложения/Event Collaboration
defaultContentType: application/json

channels:
  gateway/registrationRequested:
    publish:
      message:
        tags:
          - name: user
        name: registrationRequested
        title: Пользователь запросил регистрацию
        payload:
          type: object
          properties:
            username:
              type: string
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
            password:
              type: string
            phone:
              type: string
            address:
              type: string
        examples:
          - payload:
              username: vasya
              firstName: Василий
              lastName: Пупкин
              email: pupkin
              phone: '+71002003040'
              password: 'Jsd28xzd'
              address: 'ул Большая Филевская д 16 кв 19'


  user-service/userCreated:
    publish:
      message:
        name: UserCreated
        payload:
          type: object
          properties:
            id:
              type: integer
              format: int64
            username:
              type: string
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
            phone:
              type: string
            address:
              type: string
        examples:
          - payload:
              id: 42
              username: vasya
              firstName: Василий
              lastName: Пупкин
              email: pupkin
              phone: '+71002003040'
              password: 'Jsd28xzd'
              address: 'ул Большая Филевская д 16 кв 19'

  billing-service/accountCreated:
    publish:
      message:
        tags:
          - name: billing
        name: AccountCreated
        payload:
          type: object
          properties:
            userId:
              type: integer
            accauntId:
              type: integer
            total:
              type: number
        examples:
          - payload:
              userId: 42
              accauntId: 1488
              total: 4200.42
    subscribe:
      message:
        name: UserCreated
        payload:
          type: object
          properties:
            id:
              type: integer
              format: int64
            username:
              type: string
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
            phone:
              type: string
            address:
              type: string
        examples:
          - payload:
              id: 42
              username: vasya
              firstName: Василий
              lastName: Пупкин
              email: pupkin
              phone: '+71002003040'
              password: 'Jsd28xzd'
              address: 'ул Большая Филевская д 16 кв 19'
  notification-service/userCreated:
    subscribe:
      message:
        name: UserCreated
        payload:
          type: object
          properties:
            id:
              type: integer
              format: int64
            username:
              type: string
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
            phone:
              type: string
            address:
              type: string
        examples:
          - payload:
              id: 42
              username: vasya
              firstName: Василий
              lastName: Пупкин
              email: pupkin
              phone: '+71002003040'
              password: 'Jsd28xzd'
              address: 'ул Большая Филевская д 16 кв 19'
  notification-service/accountCreated:
    subscribe:
      message:
        tags:
          - name: billing
        name: AccountCreated
        payload:
          type: object
          properties:
            userId:
              type: integer
            accauntId:
              type: integer
            total:
              type: number
        examples:
          - payload:
              userId: 42
              accauntId: 1488
              total: 4200.42
  order-service/createOrder:
    publish:
      message:
        tags:
          - name: order
        title: Изменить баланс на аккаунте пользователя
        name: ChangeBalance
        payload:
          type: object
          properties:
            userId:
              type: integer
            accauntId:
              type: integer
            total:
              type: number
        examples:
          - payload:
              userId: 42
              total: 4200.42
    subscribe:
      message:
        tags:
          - name: order
        title: Создание заказа
        name: CreateOrder
        payload:
          type: object
          properties:
            userId:
              type: integer
            accauntId:
              type: integer
            total:
              type: number
        examples:
          - payload:
              userId: 42
              total: 4200.42
  billing-service/changeBalance:
    subscribe:
      message:
        tags:
          - name: order
        title: Изменить баланс на аккаунте пользователя
        name: ChangeBalance
        payload:
          type: object
          properties:
            userId:
              type: integer
            accauntId:
              type: integer
            total:
              type: number
        examples:
          - payload:
              userId: 42
              total: 4200.42
    publish:
      message:
        tags:
          - name: order
        title: Измененный баланс
        name: BalanceReduced
        payload:
          type: object
          properties:
            userId:
              type: integer
            accauntId:
              type: integer
            total:
              type: number
        examples:
          - payload:
              userId: 42
              total: 4200.42
